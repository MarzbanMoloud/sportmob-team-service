version: '3'
services:
    #PHP Service
    php:
        container_name: es_service_php
        build:
            context: ./docker/config/php
        volumes:
            - .:/var/www
        networks:
          es-service-network:

    #Nginx Service
    nginx:
        container_name: es_service_nginx
        image: nginx:latest
        ports:
            - 8080:80
        volumes:
            - .:/var/www
            - ./docker/config/nginx/default.conf:/etc/nginx/conf.d/default.conf
        networks:
          es-service-network:

        depends_on:
            - php

    #Redis Service
    redis:
        container_name: es_service_redis
        image: redis:latest
        networks:
          es-service-network:

    #DynamoDb locally Service
    dynamoDb:
        container_name: es_service_dynamo
        image: amazon/dynamodb-local:latest
        ports:
            - 8883:8000
        command: ["-jar", "DynamoDBLocal.jar", "-sharedDb", "-inMemory"]
        networks:
          es-service-network:

    #Zookeeper Service
    zookeeper:
        container_name: es_service_zookeeper
        image: confluentinc/cp-zookeeper
        environment:
          ZOOKEEPER_CLIENT_PORT: 2181
        networks:
          es-service-network:

    #Message Broker Service
    broker:
        container_name: es_service_broker
        image: confluentinc/cp-kafka
        environment:
          KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181
          KAFKA_ADVERTISED_LISTENERS: PLAINTEXT://broker:9092
          KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR: 1
        networks:
          es-service-network:


networks:
  es-service-network:


